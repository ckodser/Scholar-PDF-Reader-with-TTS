<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Google Scholar Reader with Annotations</title>
  <link rel="stylesheet" href="/reader-prod.css">
  <link rel="stylesheet" href="/tts/tts.css">
  <link rel="stylesheet" href="/annotation/annotation.css">
  <link rel="stylesheet" href="/AiChat/AiChat.css">

  <script src="marked.min.js"></script>

  <script src="/reader-compiled.js" defer></script>
  <script src="/annotation/annotation.js" defer></script>
  <script src="/tts/tts.js" defer></script>
  <script src="/AiChat/AiChat.js" defer></script>
  <script src="pdf.min.js" defer></script>
  <script src="pdf.worker.min.js" defer></script>

  <style>
    .hidden {
        display: none !important;
    }
  </style>
</head>
<body>
  <div class="gsr-root-wrap"></div>

  <!-- AI Chat Panel Structure - Starts hidden -->
  <div id="ai-chat-panel" class="hidden">
    <div class="chat-header">
        <h3>
            <span class="material-symbols-outlined">network_intelligence</span>
            <span id="chat-header-title">Chat with PDF</span>
        </h3>
        <div class="chat-controls">
            <button id="ai-chat-delete-btn" title="Delete All Chats">
                <span class="material-symbols-outlined">delete_forever</span>
            </button>
            <button id="ai-chat-resize-btn" title="Toggle Size">
                <span class="material-symbols-outlined">open_in_full</span>
            </button>
            <button id="ai-chat-close-btn" title="Close Chat">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>
    </div>
    <!-- Tab Container -->
    <div id="chat-tabs-container">
        <!-- Tabs will be dynamically inserted here -->
        <button id="chat-new-tab-btn" title="New Chat">+</button>
    </div>
    <div id="ai-chat-messages">
        <!-- Messages will be dynamically inserted here -->
    </div>
    <div class="chat-footer">
        <div class="chat-input-area">
            <input type="text" id="ai-chat-input" placeholder="Ask a question about the PDF...">
            <button id="ai-chat-send-btn" title="Send Message">
                <span class="material-symbols-outlined">send</span>
            </button>
        </div>
    </div>
    <!-- Overlay for when the PDF is being processed -->
    <div id="chat-processing-overlay" class="chat-processing-overlay hidden">
        <div class="loader"></div>
        <p>Analyzing PDF...</p>
    </div>
    <div id="ai-chat-delete-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Delete All Chats</h3>
            <p>Are you sure you want to delete all chat history for this PDF? This action cannot be undone.</p>
            <div class="modal-buttons">
                <button id="ai-chat-confirm-delete-yes" class="modal-button-yes">Yes, Delete All</button>
                <button id="ai-chat-confirm-delete-no" class="modal-button-no">Cancel</button>
            </div>
        </div>
    </div>
  </div>


  <div id="annotation-toolbar">
    <button id="highlight-btn" class="toolbar-button" data-tooltip="Highlight">
      <span class="material-symbols-outlined">ink_highlighter</span>
    </button>
    <button id="erase-btn" class="toolbar-button" data-tooltip="Erase">
      <span class="material-symbols-outlined">ink_eraser</span>
    </button>
    <button id="erase-all-btn" class="toolbar-button" data-tooltip="Erase All">
      <span class="material-symbols-outlined">delete</span>
    </button>
    <button id="settings-btn" class="toolbar-button" data-tooltip="Settings">
      <span class="material-symbols-outlined">settings</span>
    </button>
    <div id="tts-border" style="width: 1px; background-color: #555; margin: 5px;" class="hidden"></div>


    <button id="tts-prev-btn" class="toolbar-button hidden" data-tooltip="Previous Sentence">
        <span class="material-symbols-outlined">skip_previous</span>
    </button>
    <button id="tts-play-btn" class="toolbar-button hidden" data-tooltip="Play">
        <span class="material-symbols-outlined">play_arrow</span>
    </button>
    <button id="tts-pause-btn" class="toolbar-button hidden" data-tooltip="Pause">
        <span class="material-symbols-outlined">pause</span>
    </button>
    <button id="tts-stop-btn" class="toolbar-button hidden" data-tooltip="Stop (Esc)">
        <span class="material-symbols-outlined">stop</span>
    </button>
    <button id="tts-activate-btn" class="toolbar-button hidden" data-tooltip="Activate TTS">
        <span id="tts-activate-btn-text" class="material-symbols-outlined">volume_up</span>
    </button>
    <button id="tts-next-btn" class="toolbar-button hidden" data-tooltip="Next Sentence">
        <span class="material-symbols-outlined">skip_next</span>
    </button>

    <div id="ai-chat-border" style="width: 1px; background-color: #555; margin: 5px;" class="hidden"></div>

    <button id="chat-activate-btn" class="toolbar-button hidden" data-tooltip="Chat with AI">
        <span class="material-symbols-outlined" style="font-size: 30px;">network_intelligence</span>
    </button>
  </div>
</body>
</html>
